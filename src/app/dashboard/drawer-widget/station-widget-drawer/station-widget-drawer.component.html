<app-loading-widget
  *ngIf="isLoading"
  id="app-loading-indicator"
></app-loading-widget>

<div *ngIf="!isLoading">
  <h3 class="text-lg font-semibold">Table values</h3>

  <form [formGroup]="formColumns">
    <div formArrayName="columns">
      <div
        *ngFor="let column of getFormColumns.controls; index as formChild"
        [formGroupName]="formChild"
        class="flex justify-between items-center mt-2"
      >
        <mat-form-field appearance="outline" class="w-full">
          <mat-select formControlName="name">
            <mat-optgroup [label]="'Document Info'">
              <mat-option
                *ngFor="let column of documentInfo"
                [value]="column.value"
                [disabled]="column.disabled"
                (click)="optionSelected(column, formChild)"
              >
                {{ column.name }}
              </mat-option>
            </mat-optgroup>
            <mat-optgroup [label]="'Document Fields'">
              <mat-option
                *ngFor="let column of documentFields"
                [value]="column.value"
                [disabled]="column.disabled"
                (click)="optionSelected(column, formChild)"
              >
                {{ column.name }}
              </mat-option>
            </mat-optgroup>
          </mat-select>
        </mat-form-field>

        <button
          *ngIf="formChild"
          (click)="deleteColumn(formChild)"
          mat-icon-button
          data-testid="delete-column"
          id="delete-column"
        >
          <i class="fas text-xl fa-times"></i>
        </button>
      </div>
    </div>
  </form>

  <div class="mt-2">
    <button
      mat-stroked-button
      color="accent"
      data-testid="create-new-column"
      id="create-new-column"
      [disabled]="disabledNewColumn"
      (click)="addNewColumn()"
    >
      New Column <i class="fas fa-plus"></i>
    </button>
  </div>
</div>
